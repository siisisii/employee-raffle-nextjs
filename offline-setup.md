# คู่มือการติดตั้งและใช้งานระบบจับรางวัล (Offline Mode)

ระบบนี้ถูกปรับปรุงให้ทำงานแบบ **Offline** โดยใช้ Database ภายในเครื่อง (SQLite) ไม่ต้องต่ออินเทอร์เน็ต
เครื่อง PC จะทำหน้าที่เป็น **Host** (เครื่องแม่) และ iPad หรือเครื่องอื่นๆ สามารถเชื่อมต่อเข้ามาเป็น **Client** ผ่านวงแลน (Wi-Fi) เดียวกัน

---

## 1. การเตรียมเครื่อง Host (PC)

1.  เปิดโปรแกรม Command Prompt (cmd) หรือ Terminal
2.  ไปที่โฟลเดอร์โปรเจกต์
3.  รันคำสั่งเพื่อเริ่มระบบ:
    ```bash
    npm run build
    npm start
    ```
    _(รอจนขึ้นว่า `Ready on http://localhost:3000`)_

## 2. การหา IP Address ของเครื่อง Host

เพื่อให้ iPad เชื่อมต่อได้ ต้องรู้ IP ของเครื่อง PC ก่อน

1.  เปิด Command Prompt ใหม่
2.  พิมพ์คำสั่ง:
    ```bash
    ipconfig
    ```
3.  มองหาหัวข้อ **Wireless LAN adapter Wi-Fi** หรือ **Ethernet adapter**
4.  จดค่า **IPv4 Address** (เช่น `192.168.1.105`)

## 3. การเชื่อมต่อจาก iPad (Client)

1.  ตรวจสอบว่า iPad เชื่อมต่อ Wi-Fi ชื่อเดียวกับ PC
2.  เปิด Browser (Safari/Chrome) บน iPad
3.  พิมพ์ URL เป็น: `http://<IP-ของ-PC>:3000`
    - ตัวอย่าง: `http://192.168.1.105:3000`
4.  หน้าเว็บจะขึ้นมา และข้อมูลจะตรงกับหน้าจอ PC

## 4. การใช้งาน & การแก้ไขปัญหา

- **ข้อมูลไม่ตรงกัน?**: ระบบจะทำการ Sync ข้อมูลทุกๆ 2 วินาที หากข้อมูลไม่มา ให้ลอง Refresh หน้าจอ iPad
- **สถานะ Offline**: สังเกตที่มุมขวาบนของหน้าจอ
  - **สีเขียว (Connected)**: เชื่อมต่อกับ Host ได้ปกติ
  - **สีแดง (Offline)**: ติดต่อ Host ไม่ได้ (เช็คว่า PC เปิดโปรแกรมอยู่หรือไม่ หรือ IP เปลี่ยนหรือไม่)
- **การรีเซ็ตข้อมูล**: กดปุ่ม Reset บนหน้าเว็บ ข้อมูลจะถูกล้างทั้งบน PC และ iPad พร้อมกัน

---

## 5. การจัดการข้อมูล (Database)

ข้อมูลทั้งหมดจะถูกเก็บอยู่ในไฟล์ `raffle.db` ในโฟลเดอร์โปรเจกต์

### วิธีดูข้อมูล

1.  **ผ่าน Script**: เปิด Terminal แล้วพิมพ์:
    ```bash
    node scripts/db_manager.js view
    ```
2.  **ใช้โปรแกรมเปิดดู**: แนะนำให้โหลดโปรแกรม **DB Browser for SQLite** (ฟรี) แล้วเปิดไฟล์ `raffle.db` ดูได้เลย

### วิธีลบข้อมูล

1.  **ลบผ่านหน้าเว็บ**: กดปุ่ม Reset ในหน้า Settings ของโปรแกรม
2.  **ลบผ่าน Script**: พิมพ์:
    ```bash
    node scripts/db_manager.js clear
    ```
3.  **ลบไฟล์ทิ้ง**: ปิดโปรแกรม Server แล้วลบไฟล์ `raffle.db` ทิ้ง (เมื่อเปิดโปรแกรมใหม่ ไฟล์จะถูกสร้างขึ้นมาใหม่แบบว่างๆ)

---

**ข้อแนะนำ**: ควรตั้งค่า Fix IP ให้กับเครื่อง PC เพื่อไม่ให้เลข IP เปลี่ยนทุกครั้งที่ปิดเปิดเครื่องใหม่
